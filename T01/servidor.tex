\section{Módulo Servidor}
\begin{interfaz}{\subsection{Interfaz}}
  \seExplica{Servidor}{servidor}\\\\
  \usa{\falta}\par\noindent
  \begin{operaciones}
    \InterfazFuncion{nuevoServidor}
    {\In{k}{nat}, \In{v}{variante}, \In{r}{cola(letra)}}{servidor}
    [$tama\tilde{n}o(r)\geq tama\tilde{n}oTablero(v)*tama\tilde{n}oTablero(v)+k*\#fichas(v)$]
    {$res \igobs nuevoServidor(k,v,r)$}
    [$O(N^{2}+|\Sigma|K+FK)$]
    [Dada una cantidad de jugadores y una variante de juego, se inicia un nuevo servidor y una nueva partida de juego.]
    [\falta]\\

    \noindent\InterfazFuncion{conectar}
    {\Inout{s}{servidor}}{}
    [$\lnot empez\acute{o}?(s) \land s\igobs S_{0}$]
    {$s\igobs conectarCliente(S_{0})$}
    [$O(1)$]
    [Conecta un cliente a un servidor.]
    [\falta]\\

    \noindent\InterfazFuncion{consultar}
    {\Inout{s}{servidor}, \In{cid}{nat}}{}
    [$cid\leq \#conectados(s) \land s\igobs S_{0}$]
    {$s\igobs consultar(S_{0},cid)$}
    [$O(n)$, donde $n$ es la cantidad de mensajes en la cola de dicho cliente.]
    [Consulta la cola de notificaciones de un cliente (lo cual vacía dicha cola).]
    [\falta]\\

    \noindent\InterfazFuncion{recibir}
    {\Inout{s}{servidor}, \In{cid}{nat}, \In{o}{ocurrencia}}{}
    [$cid\leq \#conectados(s) \land s\igobs S_{0}$]
    {$s\igobs recibirMensaje(S_{0},cid,o)$}
    [\falta]
    [Recibe un mensaje de un cliente.]
    [\falta]\\

    \noindent\InterfazFuncion{clientesEsperados}
    {\In{s}{servidor}}{nat}
    [true]
    {$res\igobs \#esperados(s)$}
    [$O(1)$]
    [Obtiene el número de clientes esperados.]
    [\falta]\\

    \noindent\InterfazFuncion{clientesConectados}
    {\In{s}{servidor}}{nat}
    [true]
    {$res\igobs \#conectados(s)$}
    [$O(1)$]
    [Obtiene el número de clientes conectados.]
    [\falta]\\

    \noindent\InterfazFuncion{partida}
    {\In{s}{servidor}}{juego}
    [true]
    {$res\igobs juego(s)$}
    [$O(1)$]
    [Obtiene el juego que se está jugando en el servidor.]
    [\falta]\\

    \noindent\InterfazFuncion{empezó?}
    {\In{s}{servidor}}{bool}
    [true]
    {$res\igobs empez\acute{o}?(s)$}
    [$O(1)$]
    [Determina si la partida empezó.]
    [\falta]\\
  \end{operaciones}
\end{interfaz}

\subsection{Implementación}

\subsubsection{Representación}

\begin{Estructura}{servidor}[servidor\_estr]
\begin{Tupla}[servidor\_estr]
\begin{adjustwidth}{3em}{}\ \
  \tupItem{juego}{juego}\\
  \tupItem{jugadoresConectados}{nat}\\
  \tupItem{jugadoresEsperados}{nat}\\
  \tupItem{configuración}{tupla(\textrm{$variante:$} variante\textrm{$,\ repositorio:$} cola(letra))}\\
  \tupItem{notificaciones}{array\_dimensionable(cola(notif))}
\end{adjustwidth}\ \ \ \ \ \ \
\end{Tupla}
\end{Estructura}

\subsubsection{Invariante de Representación}

\subsubsection{Función de Abstracción}

\subsubsection{Algoritmos}

\begin{algorithm}[H]
    \defun{iNuevoServidor}{\In{k}{nat}, \In{v}{variante}, \In{r}{cola(letra)}}{servidor\_estr}
    \begin{algorithmic}[1]
        \State\asignar{res.juego}{nuevoJuego(k,v,r)}\Comment{$O(N^{2}+|\Sigma|K+FK)$}
        \State\asignar{res.jugadoresConectados}{0}
        \State\asignar{res.jugadoresEsperados}{k}
        \State\asignar{res.configuraci\acute{o}n}{\langle v,r\rangle}
        \State\asignar{res.notificaciones}{\textsc{CrearArreglo}(k)}
        \State\Return$res$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
    \defunv{iConectar}{\Inout{s}{servidor}}
    \begin{algorithmic}[1]
        \State\asignar{s.notificaciones[s.jugadoresConectados]}{\textsc{Vacía}()}
        \State$s.jugadoresConectados++$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
    \defun{iClientesEsperados}{\In{s}{servidor\_estr}}{nat}
    \begin{algorithmic}[1]
        \State\Return$s.jugadoresEsperados$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
    \defun{iClientesConectados}{\In{s}{servidor\_estr}}{nat}
    \begin{algorithmic}[1]
        \State\Return$s.jugadoresConectados$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
    \defun{iPartida}{\In{s}{servidor\_estr}}{juego}
    \begin{algorithmic}[1]
        \State\Return$s.juego$
    \end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
    \defun{iEmpezó}{\In{s}{servidor\_estr}}{bool}
    \begin{algorithmic}[1]
        \State\Return$s.jugadoresEsperados=s.jugadoresConectados$
    \end{algorithmic}
\end{algorithm}
\newpage

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
